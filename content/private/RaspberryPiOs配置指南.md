<!--
 * @Description: 
 * @Author: alphapenng
 * @Github: 
 * @Date: 2023-02-02 08:46:36
 * @LastEditors: alphapenng
 * @LastEditTime: 2023-02-02 12:57:27
 * @FilePath: /balabala/content/private/RaspberryPiOsé…ç½®æŒ‡å—.md
-->

# Raspberry Pi Os é…ç½®æŒ‡å—

- [Raspberry Pi Os é…ç½®æŒ‡å—](#raspberry-pi-os-é…ç½®æŒ‡å—)
  - [å®‰è£… OS](#å®‰è£…-os)
  - [æ›´æ–°å’Œå‡çº§ç³»ç»Ÿ](#æ›´æ–°å’Œå‡çº§ç³»ç»Ÿ)
    - [é€šè¿‡ APT æ›´æ–°å’Œå‡çº§](#é€šè¿‡-apt-æ›´æ–°å’Œå‡çº§)
  - [å®‰è£…è¾“å…¥æ³•](#å®‰è£…è¾“å…¥æ³•)
  - [åŸºæœ¬é…ç½®](#åŸºæœ¬é…ç½®)
    - [`raspi-config` å·¥å…·](#raspi-config-å·¥å…·)
    - [é…ç½®ç½‘ç»œ](#é…ç½®ç½‘ç»œ)
      - [è®¾ç½®é™æ€ ip](#è®¾ç½®é™æ€-ip)
    - [å¤–éƒ¨å­˜å‚¨é…ç½®](#å¤–éƒ¨å­˜å‚¨é…ç½®)
      - [æŒ‚è½½å¤–éƒ¨å­˜å‚¨è®¾å¤‡](#æŒ‚è½½å¤–éƒ¨å­˜å‚¨è®¾å¤‡)
      - [é…ç½®è‡ªåŠ¨æŒ‚è½½](#é…ç½®è‡ªåŠ¨æŒ‚è½½)
      - [å¸è½½å¤–éƒ¨å­˜å‚¨](#å¸è½½å¤–éƒ¨å­˜å‚¨)
  - [è¿œç¨‹æ¥å…¥](#è¿œç¨‹æ¥å…¥)

## å®‰è£… OS

æ‰“å¼€[é•œåƒä¸‹è½½é¡µé¢](https://www.raspberrypi.com/software/operating-systems/#raspberry-pi-os-32-bit)ä¸‹è½½é•œåƒå¹¶é€šè¿‡ `balenaEtcher` å†™å…¥ SD å¡ä¸­ï¼Œæˆ‘çš„æ ‘è“æ´¾æ˜¯ `4b 4GB` ç‰ˆæœ¬ï¼Œä¸‹è½½çš„é•œåƒç‰ˆæœ¬ä¸ºï¼š

```bash
Raspberry Pi OS with desktop
Release date: September 22nd 2022
System: 32-bit
Kernel version: 5.15
Debian version: 11 (bullseye)
Size: 894MB
```

## æ›´æ–°å’Œå‡çº§ç³»ç»Ÿ

### é€šè¿‡ APT æ›´æ–°å’Œå‡çº§

è½¯ä»¶æºåˆ—è¡¨åœ¨ç³»ç»Ÿ `/etc/apt/sources.list` æ–‡ä»¶å†…ï¼Œåœ¨å®‰è£…è½¯ä»¶ä¹‹å‰ï¼Œä½ åº”è¯¥æ›´æ–°ä½ çš„è½¯ä»¶æºåˆ—è¡¨è‡³æœ€æ–°ã€‚é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ›´æ–°ä½ çš„è½¯ä»¶æºï¼š

```bash
sudo apt update
```

ç„¶åï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤å‡çº§ä½ æ‰€æœ‰å·²å®‰è£…çš„è½¯ä»¶è‡³æœ€æ–°ç‰ˆæœ¬ï¼š

```bash
sudo apt full-upgrade
```

- æœç´¢è½¯ä»¶

    ```bash
    apt-cache search <package-keyword>
    ```

    æ˜¾ç¤ºåŒ…çš„è¯¦ç»†ä¿¡æ¯

    ```bash
    apt-cache show <package>
    ```

- å®‰è£…è½¯ä»¶

    ```bash
    sudo apt install <package>
    ```

- å¸è½½è½¯ä»¶

    ```bash
    sudo apt remove <package>
    ```

    æˆ–è€…é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿åŒè½¯ä»¶ç›¸å…³é…ç½®ä¸€å¹¶å¸è½½ï¼š

    ```bash
    sudo apt purge <package>
    ```

## å®‰è£…è¾“å…¥æ³•

```bash
sudo apt update
sudo apt install -y fcitx fcitx-googlepinyin
# ç­‰å¾…å®‰è£…å®Œæˆåé‡å¯
sudo reboot
```

## åŸºæœ¬é…ç½®

### `raspi-config` å·¥å…·

å‘½ä»¤è¡Œç¯å¢ƒä¸‹é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ‰“å¼€é…ç½®èœå•ï¼š

```bash
sudo raspi-config
```

### é…ç½®ç½‘ç»œ

#### è®¾ç½®é™æ€ ip

ç¼–è¾‘ç³»ç»Ÿæ–‡ä»¶ `/etc/dhcpcd.conf`ï¼Œä¾‹å¦‚ï¼š

```bash
interface eth0
static ip_address=192.168.0.4/24
static routers=192.168.0.254
static domain_name_servers=192.168.0.254 8.8.8.8
```

### å¤–éƒ¨å­˜å‚¨é…ç½®

#### æŒ‚è½½å¤–éƒ¨å­˜å‚¨è®¾å¤‡

1. æ’å…¥å¤–éƒ¨å­˜å‚¨è®¾å¤‡
2. é€šè¿‡ä»¥ä¸‹å‘½ä»¤åˆ—å‡ºæ‰€æœ‰çš„ç£ç›˜åˆ†åŒºï¼š

    ```bash
     sudo lsblk -o UUID,NAME,FSTYPE,SIZE,MOUNTPOINT,LABEL,MODEL
     ```

3. æ‰¾åˆ°ä½ çš„å¤–éƒ¨å­˜å‚¨è®¾å¤‡ï¼Œä¾‹å¦‚ `sda1`
4. `FSTYPE` åˆ—æ˜¾ç¤ºä½ çš„å­˜å‚¨è®¾å¤‡æ–‡ä»¶ç³»ç»Ÿç±»å‹ã€‚å¦‚æœä½ çš„å­˜å‚¨è®¾å¤‡æ–‡ä»¶ç³»ç»Ÿç±»å‹æ˜¯ `exFAT`ï¼Œè¯·å®‰è£… `exFAT` é©±åŠ¨ï¼š

    ```bash
    sudo apt update
    sudo apt install exfat-fuse
    ```

5. å¦‚æœä½ çš„å­˜å‚¨è®¾å¤‡æ–‡ä»¶ç³»ç»Ÿç±»å‹æ˜¯ `NTFS`ï¼Œè¯·å®‰è£… `ntfs-3g` é©±åŠ¨ï¼š

    ```bash
    sudo apt update
    sudo apt install ntfs-3g
    ```

6. é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®šä½åˆ°ä½ è¦æŒ‚è½½çš„åˆ†åŒºï¼Œä¾‹å¦‚ `/dev/sda1`ï¼š

    ```bash
    sudo blkid
    ```

7. æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œç”¨æ¥ä½œä¸ºå¤–éƒ¨å­˜å‚¨è®¾å¤‡çš„æŒ‚è½½ç‚¹ï¼š

    ```bash
    sudo mkdir /mnt/mydisk
    ```

8. æŒ‚è½½å¤–éƒ¨å­˜å‚¨è®¾å¤‡

    ```bash
    sudo mount /dev/sda1 /mnt/mydisk
    ```

9. æ£€æŸ¥æ˜¯å¦æŒ‚è½½æˆåŠŸ

    ```bash
    ls /mnt/mydisk
    ```

#### é…ç½®è‡ªåŠ¨æŒ‚è½½

1. æŸ¥è¯¢ç£ç›˜åˆ†åŒºçš„ `UUID`

    ```bash
    sudo blkid
    ```

2. å¤åˆ¶éœ€è¦è‡ªåŠ¨æŒ‚è½½è®¾å¤‡çš„ `UUID`ï¼Œä¾‹å¦‚ `5C24-1453`
3. ç¼–è¾‘ `fstab` æ–‡ä»¶

    ```bash
    sudo vim /etc/fstab
    ```

4. å°†ä»¥ä¸‹å†…å®¹æ·»åŠ è‡³ `fstab` æ–‡ä»¶ï¼Œ`UUID` æ”¹æˆä½ è‡ªå·±çš„ `UUID`ï¼Œ`fstype` æ”¹æˆä½ è‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼Œä¾‹å¦‚ `ntfs`

    ```bash
     UUID=5C24-1453 /mnt/mydisk fstype defaults,auto,users,rw,nofail 0 0
    ```

5. å¦‚æœæ–‡ä»¶ç³»ç»Ÿæ˜¯ `FAT` æˆ– `NTFS`ï¼Œåœ¨ `nofail` ä¹‹åè¦åŠ ä¸Š `,umask=000`ï¼Œè¿™ä¼šå…è®¸æ‰€æœ‰çš„ç”¨æˆ·å¯¹æŒ‚è½½çš„è®¾å¤‡æœ‰è¯»å†™æƒé™ã€‚

:warning: å¦‚æœä½ åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶æ²¡æœ‰æ’å…¥è‡ªåŠ¨æŒ‚è½½çš„å¤–éƒ¨å­˜å‚¨è®¾å¤‡ï¼Œç³»ç»Ÿä¼šåœ¨å¯åŠ¨æ—¶å¤šèŠ±è´¹ 90sï¼Œå¦‚æœä½ æƒ³ç¼©çŸ­è¿™ä¸ªæ—¶é—´ï¼Œè¯·åœ¨ `nofail` åå†ç›´æ¥åŠ ä¸Š `,x-systemd.device-timeout=30`ï¼Œè¿™ä¼šå¯¼è‡´ç³»ç»Ÿåªä¼šç­‰å¾… 30s ç„¶åæ”¾å¼ƒè‡ªåŠ¨æŒ‚è½½æ“ä½œã€‚:warning:

#### å¸è½½å¤–éƒ¨å­˜å‚¨

```bash
sudo umount /mnt/mydisk
```

ğŸ’ å¦‚ä½•å¤„ç† `target is busy` é—®é¢˜ï¼š

å‡ºç° `target is busy` æç¤ºæ„å‘³ç€æœ‰ç¨‹åºæ­£åœ¨ä½¿ç”¨ç›®æ ‡å­˜å‚¨è®¾å¤‡ä¸­çš„æ–‡ä»¶ã€‚è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å¤„ç†ï¼š

1. å…³é—­æ­£åœ¨ä½¿ç”¨ç›®æ ‡å­˜å‚¨è®¾å¤‡ä¸­æ–‡ä»¶çš„ç¨‹åºã€‚
2. å¦‚æœç»ˆç«¯æ‰“å¼€ï¼Œç¡®ä¿ä½ ä¸åœ¨æŒ‚è½½ç›®æ ‡å­˜å‚¨è®¾å¤‡ä¸­çš„ç›®å½•æˆ–å­ç›®å½•ä¸‹æ“ä½œã€‚
3. å¦‚æœä»ç„¶æ— æ³•å¸è½½ç›®æ ‡å­˜å‚¨è®¾å¤‡ï¼Œä½ å¯ä»¥é€šè¿‡ `lsof` å‘½ä»¤æ¥ç¡®è®¤å“ªäº›ç¨‹åºæ­£åœ¨æ“ä½œç›®æ ‡å­˜å‚¨è®¾å¤‡ä¸­çš„æ–‡ä»¶ã€‚é¦–å…ˆä½ éœ€è¦å®‰è£… `lsof` å‘½ä»¤

    ```bash
    sudo apt update
    sudo apt install lsof
    ```

    ç„¶åæ‰§è¡Œ `lsof` å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š

    ```bash
    lsof /mnt/mydisk
    ```

## è¿œç¨‹æ¥å…¥

